<!DOCTYPE html>
<html>
<head>
    <title>Game Chat - {{ game_id }}</title>
</head>
<body>
    <h1>Chat for Game: {{ game_id }}</h1>
    <div id="chat-log">
    </div>
    <input type="text" id="message-input">
    <button id="send-button">Send</button>

    <script>
        const gameId = "{{ game_id }}";
        const chatSocket = new WebSocket('ws://127.0.0.1:8765/');
        const chatLog = document.getElementById('chat-log');
        const messageInput = document.getElementById('message-input');
        const sendButton = document.getElementById('send-button');

        chatSocket.onopen = () => {
            console.log('WebSocket connection opened');
            chatSocket.send(JSON.stringify({ type: 'join_room', game_id: gameId }));
        };

        chatSocket.onmessage = (event) => {
            const data = JSON.parse(event.data);
            if (data.message) {
                const messageElement = document.createElement('p');
                messageElement.textContent = data.message;
                chatLog.appendChild(messageElement);
            }
        };

        chatSocket.onclose = () => {
            console.log('WebSocket connection closed');
        };

        sendButton.onclick = () => {
            const message = messageInput.value;
            if (message) {
                chatSocket.send(JSON.stringify({ type: 'chat_message', game_id: gameId, message: message }));
                messageInput.value = '';
            }
        };
    </script>
</body>
</html>